<!DOCTYPE HTML>
<!--
    FreeCodeCamp: Build a Random Quote Machine
    https://www.freecodecamp.com/challenges/build-a-random-quote-machine
-->
<html>
    <head>
        <title>Random Programming Quotes</title>
        <meta charset="utf-8" />

        <script src="https://use.fontawesome.com/2127f29eea.js"></script>
        <script id="tumblr-js" async src="https://assets.tumblr.com/share-button.js"></script>
    </head>

    <body>
        <section>
            <div id="quote">
                <blockquote>
                    <p id="quote-text"></p>
                    <cite id="quote-cite"></cite>
                </blockquote>
            </div>
            <div id="form">
                <div class=".pull-left">
                    <a href="#" id="twitter"><i class="fa fa-twitter" aria-hidden="true"></i>
</a>
                    <a href="#" id="tumblr"><i class="fa fa-tumblr" aria-hidden="true"></i>
</a>
                </div>
                <div class="pull-right">
                    <button id="submit">
                        New quote
                    </button>
                </div>
            </div>
        </section>
        <footer>
            <p>by <a href="#">giltroymeren</a></p>
        </footer>

        <script type="text/javascript">
            // http://stackoverflow.com/a/18775368
            document.addEventListener('DOMContentLoaded', function(event) {
                var myUrl = "http://quotes.stormconsultancy.co.uk/quotes.json";
                var currentQuote = currentCite = "";

                var getNewQuote = function(array) {
                    return array[Math.floor(Math.random() * (array.length + 1))];
                }

                var setNewQuote = function(array) {
                    currentQuote = array["quote"];
                    currentCite = array["author"];
                    document.getElementById("quote-text").innerHTML = currentQuote;
                    document.getElementById("quote-cite").innerHTML = currentCite;
                }

                function getFile(callback) {
                    // http://stackoverflow.com/a/16825593
                    var request = new XMLHttpRequest();
                    request.onload = function() {
                        if(request.readyState === 4 && request.status === 200) {
                            callback(request.responseText);
                        }
                    };
                    request.open("GET", "http://cors.io/?u=" + myUrl, true);
                    request.send();
                };

                var callGetFile = function() {
                    getFile(function(result) {
                        setNewQuote(getNewQuote(JSON.parse(result)));
                    });
                };

                callGetFile();

                document.getElementById("submit").onclick = function() {
                    callGetFile();
                };

                document.getElementById("twitter").onclick = function() {
                    this.href="https://twitter.com/intent/tweet?hashtags=quotes,programming," +
                    "freecodecamp&related=freecodecamp&text=\"" + currentQuote + "\" - " +
                    currentCite;
                };

                document.getElementById("tumblr").onclick = function() {
                    this.href="https://www.tumblr.com/widgets/share/tool?" +
                    "data-posttype=quote&data-tags=quotes,freecodecamp,programming&" +
                    "data-content=" + encodeURIComponent(currentQuote) +
                    "&data-caption=" + encodeURIComponent(currentCite);
                };
            });
        </script>
    </body>
</html>
